(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cea810b"],{"0eab":function(t,e,o){},"39ac":function(t,e,o){"use strict";var s=o("b4ac"),r=o.n(s);r.a},"46ea":function(t,e,o){"use strict";var s=o("0eab"),r=o.n(s);r.a},"4e6a":function(t,e,o){t.exports=o.p+"img/R-logo.95b02249.svg"},"911d":function(t,e,o){},a802:function(t,e,o){"use strict";var s=o("911d"),r=o.n(s);r.a},b4ac:function(t,e,o){},dd7b:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"login"}},[o("el-row",[o("el-col",{staticClass:"left",attrs:{md:14}},[o("login-form")],1),o("el-col",{staticClass:"right",attrs:{md:10}},[o("right")],1)],1)],1)},r=[],i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"login-reg-form"}},[t._m(0),o("h2",{staticClass:"subtitle"},[t._v("A Open Source Wiki System")]),o("el-form",{ref:"loginForm",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{prop:"name"}},[o("el-input",{attrs:{placeholder:"用户名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}},[o("template",{slot:"prepend"},[o("i",{staticClass:"el-icon-user-solid prefix"})])],2)],1),o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[o("template",{slot:"prepend"},[o("i",{staticClass:"el-icon-key prefix"})])],2)],1),o("transition",{attrs:{name:"repass"}},[!1===t.loginMode?o("el-form-item",{staticClass:"repass",attrs:{prop:"rePassword"}},[o("el-input",{attrs:{type:"password",placeholder:"再次输入密码"},model:{value:t.form.rePassword,callback:function(e){t.$set(t.form,"rePassword",e)},expression:"form.rePassword"}},[o("template",{slot:"prepend"},[o("i",{staticClass:"el-icon-key prefix"})])],2)],1):t._e()],1)],1),o("div",{class:{switch:!0,"switch-down":!t.loginMode},on:{click:function(e){t.loginMode=!t.loginMode}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.loginMode,expression:"loginMode"}]},[t._v("没有账号，点击注册")]),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.loginMode,expression:"!loginMode"}]},[t._v("已有账号，点击登录")])]),o("div",{staticClass:"btn-box",on:{click:function(e){t.loginMode?t.handleLoginClick():t.handleRegisterClick()}}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-right",circle:""}})],1),t._m(1)],1)},n=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("h1",{staticClass:"title"},[o("i",{staticClass:"el-icon-edit"}),o("span",[t._v("RWiki")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"footer"},[s("div",{staticClass:"img-wrapper"},[s("img",{attrs:{src:o("4e6a")}})]),s("div",{staticClass:"info"},[s("span",[t._v("EsunR Production")]),s("span",[t._v("\n        Github:\n        "),s("a",{attrs:{href:"https://github.com/EsunR/RWiki"}},[t._v("RWiki")])])])])}],a=(o("efce"),o("4634"),o("ed8b"),o("97a3")),c=o("591a");function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,s)}return o}function d(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(o,!0).forEach((function(e){Object(a["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(o).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var u={name:"login-reg-form",data:function(){var t=this,e=function(e,o,s){""===o?s(new Error("请输入密码")):(""!==t.form.rePassword&&!1===t.loginMode&&t.$refs.loginForm.validateField("rePassword"),s())},o=function(e,o,s){""===o?s(new Error("请再次输入密码")):o!==t.form.password?s(new Error("两次输入密码不一致!")):s()};return{form:{name:"",password:"",rePassword:""},loginMode:!0,rules:{name:[{required:!0,message:"请输入用户名",trigger:["change","blur"]}],password:[{validator:e,trigger:["change","blur"]}],rePassword:[{validator:o,trigger:["change","blur"]}]}}},methods:d({},Object(c["b"])(["changeLoginState","setUserInfo"]),{handleLoginClick:function(){var t=this;this.$refs.loginForm.validate((function(e){if(!e)return!1;t.axios.post("/base/login",t.form).then((function(e){t.$message.success("登录成功"),t._loginSuccess(e.data.data.token)})).catch((function(e){t.$message.error("".concat(e))}))}))},handleRegisterClick:function(){var t=this;this.$refs.loginForm.validate((function(e){if(!e)return!1;t.axios.post("/base/register",t.form).then((function(e){t.$message.success("注册成功，已登录"),t._loginSuccess(e.data.data.token)})).catch((function(e){t.$message.error("".concat(e))}))}))},_getUserInfo:function(){var t=this;this.axios.get("/base/getUserInfo").then((function(e){if("ok"!==e.data.msg)throw new Error(e.data.msg);t.setUserInfo(e.data.data)})).catch((function(e){console.log(e),t.$message.error(e)}))},_loginSuccess:function(t){this.changeLoginState(!0),window.localStorage.setItem("login_token",t),this._getUserInfo(),this.$store.dispatch("setFullScreen",!1),this.$store.dispatch("addKeepActive","center"),this.$router.push("/center")}})},f=u,h=(o("a802"),o("6691")),m=Object(h["a"])(f,i,n,!1,null,null,null),p=m.exports,g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"login-right"}},[o("img",{staticClass:"background-img",attrs:{src:"https://api.dujin.org/bing/1366.php"}}),o("div",{staticClass:"right-content-wrapper"},[o("h3",[t._v("每日一言 | Hitokoto")]),o("div",{ref:"hitokoto",staticClass:"hitokoto"},[o("div",{staticClass:"content"},[t._v(t._s(t.hitokoto.content))]),o("div",{staticClass:"from"},[t._v("—— "+t._s(t.hitokoto.from))]),o("div",{ref:"processBar",staticClass:"process-bar"})]),o("button",{staticClass:"fresh-button",on:{click:t.handleFresh}},[t._v("\n      Fresh\n      "),o("i",{ref:"fresh-icon",staticClass:"el-icon-refresh test"})])])])},v=[],w={data:function(){return this.freshing=!1,{hitokoto:{from:"",content:""}}},methods:{getHitokoto:function(){var t=this;return new Promise((function(e,o){t.axios.get("https://v1.hitokoto.cn/").then((function(o){t.hitokoto.content=o.data.hitokoto,t.hitokoto.from=o.data.from,e()})).catch((function(e){console.log(e),t.$message.error("".concat(e)),o()}))}))},handleFresh:function(){var t=this;if(!this.freshing)return new Promise((function(e){t.freshing=!0,t.$refs.processBar.style.width="0px";var o=t.$refs["fresh-icon"];o.classList.add("rotate"),setTimeout((function(){o.classList.remove("rotate")}),1e3);var s=t.$refs["hitokoto"];s.classList.add("hitokoto-duration"),s.classList.add("hitokoto-leave"),setTimeout((function(){s.classList.remove("hitokoto-duration"),s.classList.remove("hitokoto-leave"),s.classList.add("hitokoto-enter"),t.getHitokoto().catch((function(e){console.log(e),t.$message.error("".concat(e)),s.classList.add("hitokoto-duration"),s.classList.remove("hitokoto-enter"),t.freshing=!1})).finally((function(){s.classList.add("hitokoto-duration"),s.classList.remove("hitokoto-enter"),t.freshing=!1,e()}))}),1e3)}))},processBarAnimation:function(){var t=this,e=this.$refs.processBar,o=parseInt(window.getComputedStyle(e).width);e.style.width="".concat(o+1,"px");var s=window.getComputedStyle(this.$refs.hitokoto);o==parseInt(s.width)-80?this.handleFresh().then((function(){window.requestAnimationFrame(t.processBarAnimation)})):window.requestAnimationFrame(this.processBarAnimation)}},mounted:function(){var t=this;this.$refs.hitokoto.classList.add("hitokoto-duration"),this.$refs.hitokoto.classList.add("hitokoto-enter"),this.getHitokoto().then((function(){t.$refs.hitokoto.classList.remove("hitokoto-enter")})),setTimeout((function(){t.processBarAnimation()}),500)}},k=w,b=(o("39ac"),Object(h["a"])(k,g,v,!1,null,"03aa7c01",null)),_=b.exports,$={name:"login",components:{LoginForm:p,right:_},mounted:function(){this.$store.dispatch("setFullScreen",!0)}},C=$,y=(o("46ea"),Object(h["a"])(C,s,r,!1,null,null,null));e["default"]=y.exports}}]);
//# sourceMappingURL=chunk-2cea810b.c2c7dc49.js.map